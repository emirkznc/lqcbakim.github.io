<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Veri Giriş Uygulaması</title>
  <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7.24.7/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com/3.4.10"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;

    const App = () => {
      const [formData, setFormData] = useState({
        sicilNo: '',
        tarih: '',
        vardiya: 'Seçiniz',
        hat: 'Seçiniz',
        dummyNo: 'Seçiniz',
        jigNo: 'Seçiniz',
        hataKodu: 'Seçiniz',
        hataKoduManuel: '',
        degisenParca: 'Seçiniz',
        degisenParcaManuel: '',
        parcaAdedi: 'Seçiniz',
        aciklama: ''
      });
      const [records, setRecords] = useState([]);
      const [error, setError] = useState('');
      const [useManualHataKodu, setUseManualHataKodu] = useState(false);
      const [useManualDegisenParca, setUseManualDegisenParca] = useState(false);

      const options = {
        vardiya: ['Seçiniz', 'Sabah', 'Öğle', 'Gece'],
        hat: ['Seçiniz', 'Hat 1', 'Hat 2', 'Hat 3'],
        dummyNo: ['Seçiniz', 'D001', 'D002', 'D003'],
        jigNo: ['Seçiniz', 'J001', 'J002', 'J003'],
        hataKodu: ['Seçiniz', 'H001', 'H002', 'H003'],
        degisenParca: ['Seçiniz', 'Parça 1', 'Parça 2', 'Parça 3'],
        parcaAdedi: ['Seçiniz', '1', '2', '3', '4', '5']
      };

      const validateSicilNo = (sicil) => ['00n', '00m'].includes(sicil);

      const handleSubmit = (e) => {
        e.preventDefault();
        setError('');

        // Validation
        if (!formData.sicilNo || !formData.tarih || formData.vardiya === 'Seçiniz' || 
            formData.hat === 'Seçiniz' || !formData.aciklama ||
            (!formData.hataKodu && !formData.hataKoduManuel) ||
            (formData.hataKodu === 'Seçiniz' && !formData.hataKoduManuel)) {
          setError('Sicil No, Tarih, Vardiya, Hat, Hata Kodu ve Açıklama alanları zorunludur.');
          return;
        }

        if (!validateSicilNo(formData.sicilNo)) {
          setError('Sicil No Hatalı');
          return;
        }

        if (formData.hataKodu !== 'Seçiniz' && formData.hataKoduManuel) {
          setError('Hata Kodu için yalnızca bir seçenek kullanılabilir.');
          return;
        }
        if (formData.degisenParca !== 'Seçiniz' && formData.degisenParcaManuel) {
          setError('Değişen Parça için yalnızca bir seçenek kullanılabilir.');
          return;
        }

        const newRecord = {
          id: Date.now(),
          sicilNo: formData.sicilNo,
          tarih: formData.tarih,
          vardiya: formData.vardiya,
          hat: formData.hat,
          dummyNo: formData.dummyNo === 'Seçiniz' ? '' : formData.dummyNo,
          jigNo: formData.jigNo === 'Seçiniz' ? '' : formData.jigNo,
          hataKodu: useManualHataKodu ? formData.hataKoduManuel : (formData.hataKodu === 'Seçiniz' ? '' : formData.hataKodu),
          degisenParca: useManualDegisenParca ? formData.degisenParcaManuel : (formData.degisenParca === 'Seçiniz' ? '' : formData.degisenParca),
          parcaAdedi: formData.parcaAdedi === 'Seçiniz' ? '' : formData.parcaAdedi,
          aciklama: formData.aciklama
        };

        setRecords([...records, newRecord]);
        setFormData({
          sicilNo: '',
          tarih: '',
          vardiya: 'Seçiniz',
          hat: 'Seçiniz',
          dummyNo: 'Seçiniz',
          jigNo: 'Seçiniz',
          hataKodu: 'Seçiniz',
          hataKoduManuel: '',
          degisenParca: 'Seçiniz',
          degisenParcaManuel: '',
          parcaAdedi: 'Seçiniz',
          aciklama: ''
        });
        setUseManualHataKodu(false);
        setUseManualDegisenParca(false);
      };

      const handleInputChange = (e) => {
        const { name, value } = e.target;
        setFormData({ ...formData, [name]: value });
      };

      return (
        <div className="container mx-auto p-4">
          <h1 className="text-2xl font-bold mb-4">Veri Giriş Uygulaması</h1>
          
          {error && (
            <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
              {error}
            </div>
          )}

          <form onSubmit={handleSubmit} className="space-y-4">
            <div>
              <label className="block text-sm font-medium">Sicil No</label>
              <input
                type="text"
                name="sicilNo"
                value={formData.sicilNo}
                onChange={handleInputChange}
                className="mt-1 block w-full border rounded-md p-2"
                required
              />
            </div>

            <div>
              <label className="block text-sm font-medium">Tarih</label>
              <input
                type="date"
                name="tarih"
                value={formData.tarih}
                onChange={handleInputChange}
                className="mt-1 block w-full border rounded-md p-2"
                required
              />
            </div>

            <div>
              <label className="block text-sm font-medium">Vardiya</label>
              <select
                name="vardiya"
                value={formData.vardiya}
                onChange={handleInputChange}
                className="mt-1 block w-full border rounded-md p-2"
                required
              >
                {options.vardiya.map((option) => (
                  <option key={option} value={option}>{option}</option>
                ))}
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium">Hat</label>
              <select
                name="hat"
                value={formData.hat}
                onChange={handleInputChange}
                className="mt-1 block w-full border rounded-md p-2"
                required
              >
                {options.hat.map((option) => (
                  <option key={option} value={option}>{option}</option>
                ))}
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium">Dummy No</label>
              <select
                name="dummyNo"
                value={formData.dummyNo}
                onChange={handleInputChange}
                className="mt-1 block w-full border rounded-md p-2"
              >
                {options.dummyNo.map((option) => (
                  <option key={option} value={option}>{option}</option>
                ))}
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium">Jig No</label>
              <select
                name="jigNo"
                value={formData.jigNo}
                onChange={handleInputChange}
                className="mt-1 block w-full border rounded-md p-2"
              >
                {options.jigNo.map((option) => (
                  <option key={option} value={option}>{option}</option>
                ))}
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium">Hata Kodu</label>
              <div className="flex items-center space-x-2">
                <input
                  type="checkbox"
                  checked={useManualHataKodu}
                  onChange={() => setUseManualHataKodu(!useManualHataKodu)}
                />
                <span>Manuel Giriş</span>
              </div>
              {useManualHataKodu ? (
                <input
                  type="text"
                  name="hataKoduManuel"
                  value={formData.hataKoduManuel}
                  onChange={handleInputChange}
                  className="mt-1 block w-full border rounded-md p-2"
                />
              ) : (
                <select
                  name="hataKodu"
                  value={formData.hataKodu}
                  onChange={handleInputChange}
                  className="mt-1 block w-full border rounded-md p-2"
                >
                  {options.hataKodu.map((option) => (
                    <option key={option} value={option}>{option}</option>
                  ))}
                </select>
              )}
            </div>

            <div>
              <label className="block text-sm font-medium">Değişen Parça</label>
              <div className="flex items-center space-x-2">
                <input
                  type="checkbox"
                  checked={useManualDegisenParca}
                  onChange={() => setUseManualDegisenParca(!useManualDegisenParca)}
                />
                <span>Manuel Giriş</span>
              </div>
              {useManualDegisenParca ? (
                <input
                  type="text"
                  name="degisenParcaManuel"
                  value={formData.degisenParcaManuel}
                  onChange={handleInputChange}
                  className="mt-1 block w-full border rounded-md p-2"
                />
              ) : (
                <select
                  name="degisenParca"
                  value={formData.degisenParca}
                  onChange={handleInputChange}
                  className="mt-1 block w-full border rounded-md p-2"
                >
                  {options.degisenParca.map((option) => (
                    <option key={option} value={option}>{option}</option>
                  ))}
                </select>
              )}
            </div>

            <div>
              <label className="block text-sm font-medium">Parça Adedi</label>
              <select
                name="parcaAdedi"
                value={formData.parcaAdedi}
                onChange={handleInputChange}
                className="mt-1 block w-full border rounded-md p-2"
              >
                {options.parcaAdedi.map((option) => (
                  <option key={option} value={option}>{option}</option>
                ))}
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium">Açıklama</label>
              <textarea
                name="aciklama"
                value={formData.aciklama}
                onChange={handleInputChange}
                className="mt-1 block w-full border rounded-md p-2"
                required
              />
            </div>

            <button
              type="submit"
              className="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600"
            >
              Kaydet
            </button>
          </form>

          <div className="mt-8">
            <h2 className="text-xl font-bold mb-4">Kayıtlar</h2>
            <div className="overflow-x-auto">
              <table className="min-w-full border">
                <thead>
                  <tr className="bg-gray-100">
                    <th className="border px-4 py-2">Sicil No</th>
                    <th className="border px-4 py-2">Tarih</th>
                    <th className="border px-4 py-2">Vardiya</th>
                    <th className="border px-4 py-2">Hat</th>
                    <th className="border px-4 py-2">Dummy No</th>
                    <th className="border px-4 py-2">Jig No</th>
                    <th className="border px-4 py-2">Hata Kodu</th>
                    <th className="border px-4 py-2">Değişen Parça</th>
                    <th className="border px-4 py-2">Parça Adedi</th>
                    <th className="border px-4 py-2">Açıklama</th>
                  </tr>
                </thead>
                <tbody>
                  {records.map((record) => (
                    <tr key={record.id}>
                      <td className="border px-4 py-2">{record.sicilNo}</td>
                      <td className="border px-4 py-2">{record.tarih}</td>
                      <td className="border px-4 py-2">{record.vardiya}</td>
                      <td className="border px-4 py-2">{record.hat}</td>
                      <td className="border px-4 py-2">{record.dummyNo}</td>
                      <td className="border px-4 py-2">{record.jigNo}</td>
                      <td className="border px-4 py-2">{record.hataKodu}</td>
                      <td className="border px-4 py-2">{record.degisenParca}</td>
                      <td className="border px-4 py-2">{record.parcaAdedi}</td>
                      <td className="border px-4 py-2">{record.aciklama}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );
    };

    try {
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    } catch (error) {
      console.error('React rendering error:', error);
    }
  </script>
</body>
</html>